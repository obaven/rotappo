[env]
PRIMER_ASSEMBLY_PATH = "../primer/data/configs/bootstrap-config.yaml"
PRIMER_GITOPS_DIR = "../primer/data/output/app/exoskeleton"
PRIMER_ASSEMBLY_OUTPUT = "/tmp/primer-assembly.dot"
PRIMER_STORAGE_OUTPUT = "/tmp/primer-storage.dot"
PRIMER_MIN_STORAGE_GB = "10"
PRIMER_ROTATION = "all"

[tasks.cli-primer-help]
workspace = false
command = "cargo"
args = ["run", "--features", "cli,module-primer", "--bin", "cli", "--", "--help"]


[tasks.cli-primer-assembly-validate]
workspace = false
command = "cargo"
args = [
  "run",
  "--features",
  "cli,module-primer",
  "--bin",
  "cli",
  "--",
  "assembly",
  "validate",
  "${PRIMER_ASSEMBLY_PATH}",
]


[tasks.cli-primer-assembly-visualize-dot]
workspace = false
command = "cargo"
args = [
  "run",
  "--features",
  "cli,module-primer",
  "--bin",
  "cli",
  "--",
  "assembly",
  "visualize",
  "${PRIMER_ASSEMBLY_PATH}",
  "--view",
  "full",
  "--format",
  "dot",
  "--layout",
  "dot",
  "--output",
  "${PRIMER_ASSEMBLY_OUTPUT}",
]


[tasks.cli-primer-debug-registry]
workspace = false
command = "cargo"
args = ["run", "--features", "cli,module-primer", "--bin", "cli", "--", "debug", "registry"]


[tasks.cli-primer-debug-assembly-order]
workspace = false
command = "cargo"
args = [
  "run",
  "--features",
  "cli,module-primer",
  "--bin",
  "cli",
  "--",
  "debug",
  "assembly-order",
  "--assembly",
  "${PRIMER_ASSEMBLY_PATH}",
]


[tasks.cli-primer-cache-status]
workspace = false
command = "cargo"
args = ["run", "--features", "cli,module-primer", "--bin", "cli", "--", "cache", "status"]


[tasks.cli-primer-cache-purge]
workspace = false
command = "cargo"
args = [
  "run",
  "--features",
  "cli,module-primer",
  "--bin",
  "cli",
  "--",
  "cache",
  "purge",
  "--force",
]


[tasks.cli-primer-generate-storage]
workspace = false
command = "cargo"
args = [
  "run",
  "--features",
  "cli,module-primer",
  "--bin",
  "cli",
  "--",
  "generate",
  "storage",
  "--min-size",
  "${PRIMER_MIN_STORAGE_GB}",
]


[tasks.cli-primer-visualize-storage-dot]
workspace = false
command = "cargo"
args = [
  "run",
  "--features",
  "cli,module-primer",
  "--bin",
  "cli",
  "--",
  "visualize",
  "generate",
  "storage",
  "--min-size",
  "${PRIMER_MIN_STORAGE_GB}",
  "--format",
  "dot",
  "--layout",
  "dot",
  "--output",
  "${PRIMER_STORAGE_OUTPUT}",
]


[tasks.cli-primer-rotate-dry-run]
workspace = false
command = "cargo"
args = [
  "run",
  "--features",
  "cli,module-primer",
  "--bin",
  "cli",
  "--",
  "rotate",
  "${PRIMER_ROTATION}",
  "--assembly",
  "${PRIMER_ASSEMBLY_PATH}",
  "--dry-run",
]


[tasks.cli-primer-smoke]
workspace = false
dependencies = [
  "cli-primer-help",
  "cli-primer-assembly-validate",
  "cli-primer-assembly-visualize-dot",
  "cli-primer-debug-registry",
  "cli-primer-cache-status",
]
