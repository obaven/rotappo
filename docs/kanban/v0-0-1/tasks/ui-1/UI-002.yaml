id: UI-002
title: 'UI-1A: Phenome Runtime + State API'
type: Epic
layer: 5
domain: core
component: phenome-runtime
cli_surface:
  - phenome ui
  - phenome server

description: |
  Create a shared runtime that exposes actions, state snapshots, and
  event streams for all UI surfaces. This runtime becomes the single
  source of truth for UI data and command execution. Implement the
  runtime inside phenome so it can be developed independently and
  adapted for Bootstrappo and Rotato.

deliverables:
  - Phenome runtime modules under phenome/src/runtime
  - Action router and command registry used by all surfaces
  - State snapshot model aggregating action, capabilities, and health
  - Event bus for logs and step transitions
  - Bootstrappo + Rotato adapters for runtime data
  - UI configuration schema and persistence

acceptance_criteria:
  - UI surfaces can call a stable action API without direct CLI calls
  - State snapshot can be fetched without heavy cluster polling
  - Log and event streams support live UIs (TUI/Web/Desktop)
  - Runtime remains usable without any UI (headless CLI mode)
  - Runtime compiles as an independent crate under phenome

dependencies:
  - UI-001

children:
  - UI-007
  - UI-008
  - UI-009
  - UI-010

phase_gate: gitops
effort: M
risk: med

labels:
  - ui
  - runtime
  - api
  - core
  - phenome

source_files:
  - file: ../primer/src/main.rs
    context: "CLI entry point; invokes bootstrappo::cli::Cli::run"
  - file: ../primer/src/cli/mod.rs
    context: "CLI parser and dispatch wiring"
  - file: ../primer/src/cli/context.rs
    context: "CLI context/config wiring"
  - file: ../primer/src/cli/commands/mod.rs
    context: "CLI command registry"
  - file: ../primer/src/cli/commands/action.rs
    context: "bootstrappo assembly command handler"
  - file: ../primer/src/cli/commands/reconcile.rs
    context: "bootstrappo reconcile command handler"
  - file: ../primer/src/cli/commands/rotate.rs
    context: "bootstrappo rotate command handler"
  - file: ../primer/src/cli/commands/nuke.rs
    context: "bootstrappo nuke command handler"
  - file: ../primer/src/cli/commands/debug.rs
    context: "bootstrappo debug command handler"
  - file: ../primer/src/cli/commands/cache.rs
    context: "bootstrappo cache command handler"
  - file: ../primer/src/cli/commands/generate.rs
    context: "bootstrappo generate command handler"
  - file: ../primer/src/cli/commands/visualize.rs
    context: "bootstrappo visualize command handler"
  - file: ../primer/src/bin/test_action_load.rs
    context: "CLI test harness for action loading"

status: MustHaves
state: Backlog
status_capsule: (owner:@antigravity, updated:2026-01-01, status:backlog)
assignee: unassigned
