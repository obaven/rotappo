id: ARCH-009
title: 'MIG-1A: Phenome CLI Contract Snapshots + Golden Tests'
type: Story
layer: 5
domain: core
component: migration-cli-phenome
cli_surface:
  - terminal [actions|snapshot|action|problems|logs]

description: |
  Capture stable CLI outputs for phenome and lock them in with golden
  tests. This ensures CLI formatting and text remain unchanged unless
  intentionally updated.

deliverables:
  - Fixture inputs for action, health, and events
  - Expected output snapshots for each output mode
  - Test harness to compare current output vs fixtures
  - Update instructions for intentional changes

acceptance_criteria:
  - Tests fail on any CLI output drift
  - Fixtures run without live cluster access
  - Plain/json/ndjson formats are covered

dependencies:
  - ARCH-008

phase_gate: gitops
effort: S
risk: low

labels:
  - migration
  - cli
  - testing
  - snapshots

source_files:
  - file: src/interfaces/terminal
    context: "Phenome CLI formatting helpers"
  - file: src/bin/terminal.rs
    context: "Phenome CLI entry"
  - file: tests
    context: "Golden tests and fixtures"

status: MustHaves
state: Done
status_capsule: (owner:@antigravity, updated:2026-01-04, status:done)
assignee: unassigned
