id: UI-013
title: 'Phenome CLI Prompt/Confirm + Dry-run Guardrails'
type: Task
layer: 5
domain: core
component: phenome-cli-safety
cli_surface:
  - phenome ui
  - phenome server
  - primer rotate
  - primer nuke
  - primer reconcile

description: |
  Standardize CLI confirmations and dry-run safeguards to align with
  UI action safety gates. This reduces operator error and keeps behavior
  consistent across surfaces. Implement shared helpers in lib/phenome
  and adapt Primer prompts to use them.

deliverables:
  - Shared confirmation prompt utility
  - --yes/--no flags and consistent dry-run handling
  - Safety checks for destructive commands

acceptance_criteria:
  - Destructive commands always require confirmation or explicit flags
  - Dry-run behavior is consistent across commands
  - Prompt text uses a single shared helper

dependencies:
  - UI-003

phase_gate: gitops
effort: S
risk: low

labels:
  - ui
  - cli
  - safety
  - phenome

source_files:
  - file: lib/phenome/src/runtime/confirm.rs
    context: "Create shared prompt helper"
  - file: lib/phenome/src/adapters/primer/confirm.rs
    context: "Add shared confirmation guard for Primer commands"
  - file: lib/phenome/src/adapters/primer/rotate.rs
    context: "Apply dry-run and prompt conventions"

status: MustHaves
state: Backlog
status_capsule: (owner:@antigravity, updated:2026-01-01, status:backlog)
assignee: unassigned
